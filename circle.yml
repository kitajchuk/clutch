general:
    branches:
        only:
            - dev
            - master

machine:
    node:
        version: 6.1.0
    timezone:
        America/Los_Angeles

dependencies:
    pre:
        - node --version
        - npm --version
    # cache_directories:
    #     - "node_modules"
    override:
        # Manually clear node_modules cache...
        - rm -rf node_modules
        - npm rebuild node-sass
        - npm run bootstrap

test:
    override:
        - echo "test"

deployment:
    staging:
        branch: dev
        commands:
            - npm run build:staging
            - make -ef Circlefile deploy_staging
    production:
        branch: master
        commands:
            - npm run build:production
            - make -ef Circlefile deploy_production
